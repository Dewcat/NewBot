# Buff/Debuff技能系统重新设计

## 设计理念

根据用户需求，我们将状态效果系统重新设计为两种类型：

### 1. 伴随型状态效果（Accompanying Effects）
- **damage/healing技能**在造成伤害/治疗的同时，附带施加状态效果
- 这类技能的主要目的是造成伤害或治疗，状态效果是额外奖励
- 目标选择：buff通常施加给施法者，debuff施加给攻击目标

### 2. 纯粹型状态效果（Pure Effects）
- **专门的buff/debuff技能**，不造成伤害，只施加状态效果
- 这类技能可以指定任意目标，提供战术灵活性
- 目标选择：可以选择任意角色作为状态效果的目标

## 技能分类说明

### 📊 技能类型表

| 技能类型 | 主要效果 | 状态效果 | 目标选择 | 示例技能 |
|----------|----------|----------|----------|----------|
| `damage` | 造成伤害 | 可附带buff/debuff | buff→施法者, debuff→目标 | 强壮打击、烧伤攻击 |
| `healing` | 恢复生命 | 可附带buff | buff→施法者 | 治疗+守护 |
| `buff` | 无伤害 | 纯buff效果 | 可选择目标 | 守护祝福、强化术 |
| `debuff` | 无伤害 | 纯debuff效果 | 可选择目标 | 虚弱诅咒、易伤标记 |

## 🆕 新技能列表

### 伴随型技能（有伤害+状态效果）

| ID | 技能名称 | 类型 | 伤害 | 状态效果 | 描述 |
|----|----------|------|------|----------|------|
| 17 | 强壮打击 | damage | 1d8物理 | 强壮(3强度/3层) | 攻击时给自己增加强壮 |
| 19 | 烧伤攻击 | damage | 1d6魔法 | 烧伤(5强度/3层) | 魔法攻击附带烧伤效果 |
| 20 | 中毒箭 | damage | 1d4物理 | 中毒(15强度/2层) | 物理攻击附带中毒效果 |

### 纯增益技能（无伤害，可选目标）

| ID | 技能名称 | 类型 | 状态效果 | 描述 |
|----|----------|------|----------|------|
| 18 | 守护祝福 | buff | 守护(2强度/4层) | 给目标施加守护效果 |
| 23 | 呼吸法 | buff | 呼吸法(10强度/5层) | 给目标增加暴击率 |
| 24 | 护盾术 | buff | 护盾(30强度) | 给目标施加护盾保护 |
| 25 | 强化术 | buff | 强壮(2强度/5层) | 给目标施加强壮效果 |

### 纯减益技能（无伤害，可选目标）

| ID | 技能名称 | 类型 | 状态效果 | 描述 |
|----|----------|------|----------|------|
| 21 | 虚弱诅咒 | debuff | 虚弱(2强度/3层) | 给目标施加虚弱效果 |
| 22 | 易伤标记 | debuff | 易伤(1强度/4层) | 给目标施加易伤效果 |
| 26 | 恐惧术 | debuff | 虚弱(3强度/2层) | 强力虚弱效果 |
| 27 | 破甲诅咒 | debuff | 易伤(2强度/3层) | 强力易伤效果 |

## 🎮 使用体验

### 战术层面的改进

1. **灵活的目标选择**：
   - 纯buff技能：可以给任何友方角色施加增益
   - 纯debuff技能：可以给任何敌方角色施加减益
   - 支持团队协作策略

2. **明确的技能定位**：
   - 伴随型：战斗中的额外收益
   - 纯粹型：专门的战术支援

3. **战斗节奏控制**：
   - 可以在战斗开始前预先布置buff
   - 可以精确控制debuff的施加时机

### 实际战斗流程

#### 传统伤害+状态效果：
```
/attack → 选择强壮打击 → 选择敌人
结果：造成伤害 + 自己获得强壮效果
```

#### 纯粹状态效果施加：
```
/attack → 选择守护祝福 → 选择队友
结果：队友获得守护效果（无伤害）
```

## 📋 技术实现细节

### 目标选择逻辑

```python
# buff技能的目标选择
if skill_category == 'buff':
    # 纯buff技能：效果施加给选中的目标
    buff_target = target
else:
    # 伴随buff的damage/healing技能：效果施加给施法者
    buff_target = attacker

# debuff技能的目标选择
if skill_category == 'debuff':
    # 纯debuff技能：效果施加给选中的目标
    debuff_target = target
else:
    # 伴随debuff的damage技能：效果施加给攻击目标
    debuff_target = target
```

### 伤害计算

- **damage类型**：正常计算伤害，附加状态效果
- **healing类型**：正常计算治疗，附加状态效果
- **buff/debuff类型**：伤害值为0，只处理状态效果

## 🔄 迁移说明

- 旧的状态效果技能已被更新
- 保持数据库兼容性
- 角色已学习的技能会自动更新为新设计

---

**更新时间**: 2025年7月27日  
**版本**: v2.1.0 - Buff/Debuff系统重设计  
**向后兼容**: 是，自动迁移现有技能
