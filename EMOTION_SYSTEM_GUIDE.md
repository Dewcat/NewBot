# 情感系统使用指南

## 概述

情感系统是SimpleBot的一个高级功能，它为角色添加了情感等级和情感硬币机制，让战斗更加丰富和有趣。

## 核心概念

### 情感等级
- 每个角色都有一个情感等级（0-5级）
- 初始等级为0，最高等级为5
- 情感等级影响可使用的技能和获得的特殊效果

### 情感硬币
- 有两种类型：正面情感硬币和负面情感硬币
- 通过各种战斗行为获得硬币
- 硬币用于升级情感等级

### 升级要求
各等级升级所需的硬币数量（正面+负面）：
- 1级：需要3个硬币
- 2级：需要3个硬币
- 3级：需要5个硬币
- 4级：需要7个硬币
- 5级：需要9个硬币

## 获得情感硬币的方式

### 1. 骰子投掷
- 投出最大值（如6面骰投出6）：获得1个正面硬币
- 投出最小值（如6面骰投出1）：获得1个负面硬币

### 2. 战斗伤害
- 造成伤害：每次造成伤害获得1个正面硬币
- 击杀敌人：额外获得2个正面硬币
- 受到伤害：每次受到伤害获得1个负面硬币

### 3. 治疗行为
- 治疗他人：每次治疗他人获得1个正面硬币
- 接受治疗：每次接受他人治疗获得1个正面硬币
- 自我治疗：每次自我治疗只获得1个正面硬币（不重复计算）

### 4. 其他战斗行为
- 死亡事件：获得负面硬币
- 特殊技能效果：可能获得特定类型的硬币

## 升级机制

### 升级条件
- 当角色的正面硬币+负面硬币总数≥升级要求时，角色进入"待升级"状态
- 进入待升级状态的角色在本回合不再获得情感硬币

### 升级时机
- 升级在回合开始时触发（使用`/end_turn`命令时）
- 所有待升级角色会自动升级

### 升级效果
1. **情感等级+1**
2. **获得升级效果**：
   - 正面硬币多：获得正面效果（如强壮buff）
   - 负面硬币多：获得负面效果（如守护buff）
3. **技能冷却-1回合**：所有技能的当前冷却时间减少1回合
4. **硬币清零**：升级后硬币数量重置为0

## 情感效果

### 正面情感效果池
- **强壮**：每回合开始时获得1级强壮状态

### 负面情感效果池  
- **守护**：每回合开始时获得1级守护状态

## 技能限制

- 某些高级技能可能需要特定的情感等级才能使用
- 尝试使用等级不足的技能时会收到错误提示

## 使用建议

### 策略规划
1. **平衡发展**：根据战斗需求选择获得正面或负面硬币的机会
2. **时机把握**：在合适的时机升级，获得战斗优势
3. **技能搭配**：利用情感等级解锁更强的技能组合

### 实战技巧
1. **积极参与**：多进行攻击和治疗行为可快速获得正面硬币
2. **平衡策略**：承受伤害获得负面硬币，升级获得守护效果
3. **骰运把握**：关注骰子结果，把握硬币获得时机
4. **团队合作**：互相治疗可以让全队都获得正面硬币

## 系统状态查看

通过角色状态查看命令可以看到：
- 当前情感等级
- 正面情感硬币数量
- 负面情感硬币数量
- 是否处于待升级状态

## 注意事项

1. **最大等级限制**：达到5级后不再获得情感硬币
2. **待升级状态**：处于待升级状态时本回合不获得新硬币
3. **升级不可逆**：升级后硬币清零，无法撤销
4. **效果叠加**：情感效果会与其他状态效果叠加

## 开发者信息

### 数据库字段
- `emotion_level`：情感等级（0-5）
- `positive_emotion_coins`：正面情感硬币数量
- `negative_emotion_coins`：负面情感硬币数量  
- `pending_emotion_upgrade`：是否待升级（0或1）

### 相关表
- `character_emotion_effects`：角色情感效果
- `emotion_level_history`：情感等级历史记录
- `emotion_coin_log`：情感硬币获得日志

### 核心模块
- `character/emotion_system.py`：情感系统核心逻辑
- 集成到攻击系统、回合管理系统中

## 版本信息
- 版本：1.0
- 更新日期：2025-09-07
- 状态：已实装并测试
